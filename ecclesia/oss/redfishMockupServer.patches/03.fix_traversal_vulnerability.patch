--- redfishMockupServer.py
+++ redfishMockupServer.py
@@ -64,6 +64,10 @@
     return path
 
 
+def is_safe_path(basedir, path):
+    return os.path.realpath(path).startswith(basedir)
+
+
 class RfMockupServer(BaseHTTPRequestHandler):
         '''
         returns index.json file for Serverthe specified URL
@@ -300,6 +304,9 @@
             fpath_xml = self.construct_path(self.path, 'index.xml')
             fpath_headers = self.construct_path(self.path, 'headers.json')
             fpath_direct = self.construct_path(self.path, '')
+            if not is_safe_path(self.server.mockDir, fpath_direct):
+                self.send_response(404)
+                self.end_headers()
 
             # If bool headers is true and headers.json exists...
             # else, send normal headers for given resource
@@ -338,6 +345,9 @@
             fpath_xml = self.construct_path(self.path, 'index.xml')
             fpath_headers = self.construct_path(self.path, 'headers.json')
             fpath_direct = self.construct_path(self.path, '')
+            if not is_safe_path(self.server.mockDir, fpath_direct):
+                self.send_response(404)
+                self.end_headers()
 
             success, payload = self.get_cached_link(fpath)
 
